<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acceso Consultores - Escencial</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .login-card { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 350px; text-align: center; border-top: 5px solid #3498db; }
        .login-card h2 { color: #2c3e50; margin-bottom: 5px; }
        .login-card p { color: #7f8c8d; font-size: 0.9rem; margin-bottom: 25px; }
        input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: #3498db; color: white; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px;}
        button:hover { background: #2980b9; }
        #mensaje { margin-top: 15px; font-size: 0.85rem; color: #e74c3c; display: none; }
        .loader { display: none; margin-top: 15px; color: #3498db; }
    </style>
</head>
<body>

    <div class="login-card">
        <i class="fas fa-user-circle" style="font-size: 3rem; color: #3498db;"></i>
        <h2>Portal Consultores</h2>
        <p>Escencial Consultora</p>
        
        <input type="email" id="email" placeholder="Ingresa tu email registrado" required>
        <button onclick="iniciarSesion()">Ingresar al Panel</button>
        
        <div id="loader" class="loader"><i class="fas fa-spinner fa-spin"></i> Verificando credenciales...</div>
        <div id="mensaje">Usuario no encontrado o no autorizado.</div>
    </div>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbx-Q1S3S15loP-wlW2dcD1pZWPh4kmUyL-wUw5xJn50a836kR-Ca7-ufKv1-YtXSdA9/exec";

        async function iniciarSesion() {
            const emailIngresado = document.getElementById('email').value.trim().toLowerCase();
            if (!emailIngresado) return alert("Por favor ingresa tu email.");

            document.getElementById('loader').style.display = 'block';
            document.getElementById('mensaje').style.display = 'none';

            try {
                const response = await fetch(SCRIPT_URL + "?type=getConsultores");
                const consultores = await response.json();
                
                // Buscar si el email existe en la base de datos
                const consultorValido = consultores.find(c => c[1].trim().toLowerCase() === emailIngresado);

                if (consultorValido) {
                    // Guarda el NOMBRE del consultor en la memoria del navegador
                    localStorage.setItem('consultorNombre', consultorValido[0]);
                    window.location.href = "usuario.html"; // Redirige al panel
                } else {
                    document.getElementById('loader').style.display = 'none';
                    document.getElementById('mensaje').style.display = 'block';
                }
            } catch (error) {
                alert("Error de conexi√≥n con el servidor.");
                document.getElementById('loader').style.display = 'none';
            }
        }
    </script>
</body>
</html>